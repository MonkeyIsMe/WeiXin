<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="js/jquery.min.js"></script>
    <link href="css/Common.css" type="text/css" rel="styleSheet">
    <link href="css/bootstrap-theme.css" type="text/css" rel="styleSheet">
    <link href="css/bootstrap.css" type="text/css" rel="styleSheet">
    <script src="js/bootstrap.min.js"></script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
	<script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<body>

</body>
<script type="text/javascript">

var apppid ="wxea7cdd5c1ebc8cd3";
var timestamp;
var nonceStr;
var signature;

$(function(){
	$.ajaxSettings.async = false;
	$.post(
			"lo.do",
			{
			},
			function(data){
				var data = JSON.parse(data);
				console.log(data);
				timestamp = data.timestamp;
				nonceStr = data.nonce_str;
				signature = data.signature;
			}
			);
	
	wx.config({
	    debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
	    appId: apppid, // 必填，公众号的唯一标识
	    timestamp: timestamp , // 必填，生成签名的时间戳
	    nonceStr: nonceStr, // 必填，生成签名的随机串
	    signature: signature,// 必填，签名，见附录1
	    jsApiList: [
	        // 所有要调用的 API 都要加到这个列表中
	        'checkJsApi',
	        'openLocation',
	        'getLocation'
	      ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
	});
	
	wx.checkJsApi({
	    jsApiList: [
	        'getLocation'
	    ],
	    success: function (res) {
	        // alert(JSON.stringify(res));
	        // alert(JSON.stringify(res.checkResult.getLocation));
	        if (res.checkResult.getLocation == false) {
	            alert('你的微信版本太低，不支持微信JS接口，请升级到最新的微信版本！');
	            return;
	        }
	    }
	});
	
	var latitude;  
	var longitude;  
	var speed;  
	var accuracy; 

	
});

wx.getLocation({
    success: function (res) {
        var latitude = res.latitude; // 纬度，浮点数，范围为90 ~ -90
        var longitude = res.longitude; // 经度，浮点数，范围为180 ~ -180。
        var speed = res.speed; // 速度，以米/每秒计
        var accuracy = res.accuracy; // 位置精度
        alert(latitude + " " + longitude);
    },
    cancel: function (res) {
        alert('用户拒绝授权获取地理位置');
    }
});
		

</script>
</html>